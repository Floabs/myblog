---
title: "Token==Cookie"
date: 2025-05-18
summary: "In some cases both CSFR Token and CSFRKey(cookie) are equal and the server only checks for correct format / if they are same"
tags: ["web", "csrf", "csfr-token", "token-cookie"]
source: "cherrytree"
---

In some cases both CSFR Token and CSFRKey(cookie) are equal and the server only checks for correct format / if they are same

To perform this attack we still need to be able to inject a cookie with
	HTTP HEADER INJECTION - required
		but it doesnt need to be a valid one.

Test by entering random values both same tho -> still works. we good

Search for vulnerable endpoint that allows you to set cookies:

Also always make sure to doublecheck what exactly the cookie name is:
it can be csrfKey or just csfr - it has to match:

searchitem%0d%0aSet-Cookie:%20csrf=YOUAREHACKEDCOOKIE%3b%20SameSite=None

Write exploit script:

![Screenshot](63719711b08c95332ba84fa6a4fb09fcd62808c2372a0b96911cfafe88c97722.png)
![Screenshot](0d73a82a7439d9cad65cd3a99c64f3c397fbc7fedbd6117c042dce258aaa0f6d.png)
![Screenshot](a485cde70660c3405745d20ba3692905c6d3633009b114c5505d3ba6584ec3dd.png)
