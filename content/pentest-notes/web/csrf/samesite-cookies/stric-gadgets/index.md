---
title: "STRIC - Gadgets"
date: 2025-05-18
summary: "Notes and commands for STRIC - Gadgets."
tags: ["web", "csrf", "samesite-cookies", "stric-gadgets"]
---
Bypassing SameSite restrictions using on-site gadgets

As far as browsers are concerened, client side redirects aren't redirects at all So it's always a same side redirect and will include all cookies. Doesn't work itf its server side -> browser recognizes it on follow and the restrictions apply.

### So what we essentially are looking for are redirects f.e: comments

### We find posting a comment redirects us: looking at burp we find

### Looking at the request we can see javascript code

Looking at the code we see how the redirect  is buuult and that it depends on a controllable parameter ("postID");

But since its a redirect from here with the given parameter we try it in browser, and not burp. /post/comment/confirmation?postId=

Got 404 - cause we still have /post before /my-account but generally worked

Need to use patah traversel with../ and also append the other parameters from a GET request to change the email: /my-account/change-email?email=wiener1%40whatever.com&submit=1

We also need to make sure the &submit=1 is url encoded

I usually just urlencode everything after the = to be safe: Just make sure go step by step andd check it still works, also always make sure to actually use the redirect and not FQDM [https://0ad300c9031d82ab8375054b00840060.web-security-academy.net/post/comment/confirmation?postId=../my-account/change-email?email=noclue%40whatever.com%26submit=1](https://0ad300c9031d82ab8375054b00840060.web-security-academy.net//post/comment/confirmation?postId=../my-account/change-email?email=noclue%40whatever.com%26submit=1) "

### Write script

![Screenshot](d7e534a5958191e8e514ef806a3b6464068ade9e4f5ebdd36a577df15cbfead9.png)
![Screenshot](f6caa4e22a68f03325b84b53e03c3eee17b0bfbe9d367ec70c5731b5b125cf37.png)
![Screenshot](6f654d75aab787ca86df40241d6a6c572092c2d6129a3c480f34c7e2f0dee361.png)
![Screenshot](a039b0f63a937fd86af2a4b7cf4e2badfcf70e8c576ce18269d175ba538f384c.png)
![Screenshot](1669772901e7e3a43ad2ec5432214a78fe5b0a0fdeade1f4063d507e7e2380e5.png)
![Screenshot](06f0ee139770b5cec067afa779431a830e416d94d0268c13099ab8e4f3e6fb11.png)
![Screenshot](98a29c847fe7282b30d7a86fe12220948451a05f5446c00d3a26cfe49ccd965a.png)
